---
title: "task4"
output:
    html_document:
        df_print: paged
---



```{r, include=FALSE}
# knitr::opts_chunk$set(fig.width = 8, fig.height = 8)

# library(testit)

# library(readxl)
library(mvtnorm)
library(ggplot2)
# library(GGally) # pairwise plot
# library(stringr) # str_squish

# library(correlation) # cor_sort
library(tidyr)
# library(ppcor)
library(dplyr) # dataframe
library(reshape2)
# library(bbmle)
# library(graphics)

if (interactive()) setwd("R/practice/")
# setwd("R/Statistical_Analysis_2022/Partial_Correlation_CARDATA/Tkachenko")
```


```{r}
ring <- read.table("ring.txt", col.names = c("x", "y"))
```

1. Промоделировать траекторию марковской цепи при помощи алгоритма Метрополиса-Гастингса
с подходящим пробным распределением (proposal distribution).
2. Исследовать траекторию цепи на сходимость (выход на стационарность, автокорреляцию). При
необходимости убрать burn-in интервал и провести прореживание.
3. Везде убедиться в том, что получена выборка именно из нужного распределения.

10. Исходная работа Хастингса в 1970 г. была посвящена моделированию стандартного нормального распределения с использованием в качестве пробного распределения случайного блуждания с отдельными шагами, полученными из равномерного распределения на отрезке (−δ, δ), δ > 0.
(a) Исследуйте свойства алгоритма Метрополиса-Гастингса и получаемой цепи при разных значениях δ (например, δ = 0.1, 1, 10 или другие). Какое значение δ будем оптимальным с точки зрения автокорреляции цепи?
(b) Промоделируйте выборку из N (0, 1) с использованием других распределений для приращений: Коши и Лапласа (с параметром λ = 1). Сравните свойства получаемой марковской цепи.
(c) Для трех вышеобозначенных примеров случайного блуждания (с равномерными приращениями на интервале, из распределений Коши и Лапласа) исследуйте возможность получения вероятности перехода в следующее состояние цепи близкой к 0.25 за счет правильного подбора параметров.




```{r}
mc <- 0

step(x, Q, P = dnorm)
```