\documentclass[specialist, substylefile = spbureport.rtx,
    subf,href,colorlinks=true, 12pt]{disser}

% \usepackage[a4paper, mag=1000, includefoot,
%     left=2cm, right=1.5cm, top=2cm, bottom=2cm, headsep=1cm, footskip=1cm]{geometry}

\usepackage[a4paper, top=2cm, bottom=2cm, left=2cm, right=2cm]{geometry}

\usepackage[T1,T2A]{fontenc}

\usepackage{graphicx}
\graphicspath{ {images/} }
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amsthm} %for \newtheorem*
\usepackage{bm}
\usepackage[english,russian]{babel}

% \usepackage{polyglossia}
% \usepackage{fontspec}
% \setmainfont{Times New Roman}
% \setsansfont{Arial}
% \setmonofont{Courier New}


% c++ code
\usepackage{listings}
\usepackage{xcolor}
\lstset { %
    language=C++,
    backgroundcolor=\color{black!5}, % set backgroundcolor
    basicstyle=\footnotesize,% basic font setting
}




\newtheorem*{definition}{Определение}
\newtheorem*{example}{Пример}
\newtheorem*{hypothesis}{Гипотеза}
\newtheorem*{question}{Вопрос}
\newtheorem*{algorithm}{Алгоритм}

% \newcommand{\rank}{\mathsf{rank}\ }







\institution{Санкт-Петербургский государственный университет\\
    Математико-механический факультет\\
    Кафедра Статистического Моделирования
}
\title{«Научно-исследовательская работа» (семестр 7)}
\topic{Разработка программных средств и решение задач принятия решений с помощью методов тропической математики.}
\author{Ткаченко Егор Андреевич}
\group{группа 19.Б04-мм}
\sa       {Кривулин Николай Кимович}
\sastatus {д.\,ф.-м.\,н., профессор}
\city{Санкт-Петербург}
\date{2023}


\begin{document}

    \maketitle
    \pagebreak
    \tableofcontents
    \pagebreak

    \intro

        Многокритериальные задачи оценки альтернатив на основе парных сравнений составляют важный класс задач принятия решений, которые встречаются во многих областях научной и практической деятельности. Пусть имеется набор альтернатив (способов, вариантов) принятия некоторого решения. Известны количественные результаты парных сравнений, при которых любые две альтернативы сравниваются между собой в соответствии с несколькими критериями. Результаты сравнений могут быть получены, например, путем опроса респондентов (экспертов, покупателей, избирателей) или с помощью других процедур сравнения. Требуется на основе относительных результатов парных сравнений определить абсолютный рейтинг (приоритет, степень предпочтения, вес) каждой альтернативы для принятия решения. Такие задачи встречаются при принятии управленческих решений в менеджменте, изучении предпочтений потребителей в маркетинге, анализе социологических опросов в социологии, прогнозе результатов выборов в политологии и в других областях \cite{Krivulin2020Reshenie}. 

        Для решения задач оценки альтернатив на основе парных сравнений существует два вида методов --- эвристические алгоритмы и строго обоснованные математические решения (аналитические методы).

        Одним из аналитических решений является метод аппроксимации матрицы парных сравнений в log-чебышевской метрике. Данный метод хорошо записывается в терминах max-алгебры \cite{Krivulin2019Metody}.

        Имеется проблема разработки эффективных программных средств для решения задач с помощью max-алгебры, в частности, задачи принятия решений. Настоящая работа направлена на решение указанной проблемы и имеет целью разработку указанных программных средств.


    \chapter{Задачи принятия решений}

    % \section{Постановка задачи принятия решений}

    \section{Однокритериальная задача принятия решений на основе парных сравнений}
        Дано $n$ альтернатив $\mathcal{A}_{1},\ldots,\mathcal{A}_{n}$ принятия решения, которые сравниваются попарно. Результаты сравнений записываются в виде матрицы парных сравнений $\bm{A}=(a_{ij})$ порядка $n$, где элемент $a_{ij}>0$ показывает во сколько раз альтернатива $\mathcal{A}_{i}$ превосходит альтернативу $\mathcal{A}_{j}$. Требуется на основе относительных результатов парных сравнений определить вектор $\bm{x}$ абсолютных рейтингов альтернатив \cite{Krivulin2020Reshenie}.

    \section{Многокритериальная задача принятия решений на основе парных сравнений}
        Рассмотрим задачу оценки рейтингов альтернатив, в которой $n$ альтернатив $\mathcal{A}_{1},\ldots,\mathcal{A}_{n}$ сравниваются попарно по $m$ критериям. Пусть $\bm{A}_{k}$ обозначает матрицу порядка $n$ результатов парных сравнений альтернатив в соответствии с критерием $k=1,\ldots,m$. Критерии также сравниваются попарно, а результаты их сравнений образуют матрицу $\bm{C}=(c_{kl})$, где $c_{kl}$ показывает во сколько раз критерий $k$ важнее для принятия решения, чем $l$. Необходимо на основе матриц парных сравнений $\bm{C}$ и $\bm{A}_{1},\ldots,\bm{A}_{m}$ найти абсолютный индивидуальный рейтинг каждой альтернативы \cite{Krivulin2020Reshenie}.


    \chapter{Элементы тропической математики}

    Используются определения max-алгебры и ее элементов из работ \cite{Krivulin2020Reshenie, Krivulin2019Metody}.

    \begin{definition}
        Max-умножить алгебра --- множество $\mathbb{R}_+ = \{x \in \mathbb{R} \, |\, x \geq 0\}$ с операциями сложения и умножения.
    \end{definition}

        Сложение обозначается символом $\oplus$ и для всех $x,y\in\mathbb{R}_{+}$ определено как максимум: $x\oplus y=\max\{x,y\}$. Эта операция обладает свойством идемпотентности в силу того, что ${x\oplus x=\max\{x,x\}=x}$. Обратного по сложению (противоположного) элемента не существует, а потому операция вычитания в max-алгебре не определена.

        Умножение определено и обозначается как обычно. Нейтральные элементы по сложению и умножению совпадают с арифметическими нулем и единицей. Понятия обратного элемента по умножению и степени, в том числе рациональной, числа имеют обычный смысл. 
        
        Векторные и матричные операции выполняются по стандартным правилам с заменой арифметического сложения на операцию $\oplus$. В частности, умножение вектора или матрицы на скаляр ничем не отличается от соответствующих операций в обычной арифметике. Нулевой вектор, который обозначается символом $\bm{0}$, нулевая матрица, а также положительный вектор имеют стандартный вид.

        Для ненулевого вектора-столбца $\bm{x}=(x_{j})$ определен мультипликативно сопряженный вектор-строка $\bm{x}^{-}=(x_{j}^{-})$, где $x_{j}^{-}=x_{j}^{-1}$, если $x_{j}\ne0$, и $x_{j}^{-}=0$ в противном случае. Для вектора из единиц, который обозначается как $\bm{1}$, выполняется $\bm{1}^{-}=\bm{1}^{\mathrm{T}}$.
        
        Мультипликативно сопряженное транспонирование преобразует ненулевую матрицу $\bm{A}=(a_{ij})$ в матрицу $\bm{A}^{-}=(a_{ij}^{-})$, где $a_{ij}^{-}=a_{ji}^{-1}$, если $a_{ji}\ne0$, иначе $a_{ij}^{-}=0$.

        Линейной комбинацией векторов $\bm{a}_{1},\ldots,\bm{a}_{n}$ с коэффициентами $x_{1},\ldots,x_{n}\in\mathbb{R}_{+}$ называется выражение $x_{1}\bm{a}_{1}\oplus\cdots\oplus x_{n}\bm{a}_{n}$. Вектор $\bm{b}$ линейно зависит от векторов $\bm{a}_{1},\ldots,\bm{a}_{n}$, если существуют числа $x_{1},\ldots,x_{n}\in\mathbb{R}_{+}$ такие, что выполняется равенство $\bm{b}=x_{1}\bm{a}_{1}\oplus\cdots\oplus x_{n}\bm{a}_{n}$. Коллинеарность двух векторов имеет обычный смысл: векторы $\bm{a}$ и $\bm{b}$ являются коллинеарными, если $\bm{b}=x\bm{a}$ для некоторого $x\in\mathbb{R}_{+}$.

        Множество всех линейных комбинаций $x_{1}\bm{a}_{1}\oplus\cdots\oplus x_{n}\bm{a}_{n}$ векторов $\bm{a}_{1},\ldots,\bm{a}_{n}$ образует тропическое линейное пространство. Любой вектор $\bm{y}$ пространства выражается с помощью (тропического) произведения матрицы $\bm{A}=(\bm{a}_{1},\ldots,\bm{a}_{n})$, составленной из этих векторов как столбцов, и некоторого вектора $\bm{x}=(x_{1},\ldots,x_{n})^{\mathrm{T}}$ в виде $\bm{y}=\bm{A}\bm{x}$.

        Рассмотрим квадратные матрицы с элементами из max-алгебры. Единичная матрица обозначается символом $\bm{I}$ и имеет обычный вид. Целая неотрицательная степень квадратной матрицы $\bm{A}$ обозначает (тропические) произведения матрицы на себя и определена для всех натуральных $p$ так, что $\bm{A}^{0}=\bm{I}$, $\bm{A}^{p}=\bm{A}^{p-1}\bm{A}=\bm{A}\bm{A}^{p-1}$.

        След матрицы $\bm{A}=(a_{ij})$ порядка $n$ вычисляется по формуле 
        $$\mathop\mathrm{tr}\bm{A}=a_{11}\oplus\cdots\oplus a_{nn}.$$

        Спектральным радиусом матрицы $\bm{A}$ называется число, которое вычисляется по формуле
        \begin{equation*}
        \lambda
        =
        \mathop\mathrm{tr}\bm{A}\oplus\cdots\oplus\mathop\mathrm{tr}\nolimits^{1/n}(\bm{A}^{n})
        =
        \bigoplus_{i=1}^{n}{\mathop\mathrm{tr}}^{1/i}(\bm{A}^{i}).
        \end{equation*}

        При условии, что $\lambda\leq1$, определен оператор Клини (звезда Клини), который сопоставляет матрице $\bm{A}$ матрицу
        \begin{equation*}
        \bm{A}^{\ast}
        =
        \bm{I}\oplus\bm{A}\oplus\cdots\oplus\bm{A}^{n-1}
        =
        \bigoplus_{i=0}^{n-1}\bm{A}^{i}.
        \end{equation*}

    \chapter{Решение многокритериальной задачи парных сравнений}

    Далее приведен алгоритм решения использующий аппроксимацию матриц сравнений в log-чебышевской метрике, подробнее описанный в работах \cite{Krivulin2019Metody,Krivulin2019Tropical,Krivulin2022Using}. 

    \begin{itemize}
        \item[1.]
        Для матрицы $\bm{C}$ находится спектральный радиус $\lambda$, составляется матрица $\lambda^{-1}\bm{C}$, а затем в параметрической форме определяется вектор весов критериев
        $$
        \bm{w}
        =
        (\lambda^{-1}\bm{C})^{\ast}\bm{v},
        \qquad
        \bm{v}>\bm{0},
        \qquad
        \lambda
        =
        \bigoplus_{i=1}^{m}{\mathop\mathrm{tr}}^{1/i}(\bm{C}^{i}).
        $$
        \item[2.]
        Если вектор $\bm{w}$ не единственный (с точностью до положительного множителя), то определяются наилучший и наихудший дифференцирующие векторы весов.
        \begin{itemize}
        \item[2.1.]
        Наилучший дифференцирующий вектор весов находится в параметрическом виде с использованием вектора параметров $\bm{v}_{1}$ по формуле:
        $$
        \bm{w}_{1}
        =
        \bm{P}(\bm{I}\oplus\bm{P}_{lk}^{-}\bm{P})\bm{v}_{1},
        \qquad
        \bm{v}_{1}
        >
        \bm{0},
        $$
        где матрица $\bm{P}=(\bm{p}_{j})$ получена из $(\lambda^{-1}\bm{C})^{\ast}$ вычеркиванием линейно зависимых столбцов, матрица $\bm{P}_{lk}$ получена из $\bm{P}=(p_{ij})$ обнулением всех элементов, кроме $p_{lk}$, а индексы $k$ и $l$ определяются, исходя из условий:
        $$
        k
        =
        \arg\max_{j}\bm{1}^{\mathrm{T}}\bm{p}_{j}\bm{p}_{j}^{-}\bm{1},
        \qquad
        l
        =
        \arg\max_{i}p_{ik}^{-1}.
        $$
        \item[2.2.]
        Наихудший дифференцирующий вектор весов находится в параметрическом виде с использованием вектора параметров $\bm{v}_{2}$ по формулам:
        $$
        \bm{w}_{2}
        =
        (\Delta^{-1}\bm{1}\bm{1}^{\mathrm{T}}\oplus\lambda^{-1}\bm{C})^{\ast}\bm{v}_{2},
        \qquad
        \bm{v}_{2}
        >
        \bm{0},
        \qquad
        \Delta
        =
        \bm{1}^{\mathrm{T}}(\lambda^{-1}\bm{C})^{\ast}\bm{1}.
        $$
        \end{itemize}
        \item[3.]
        С помощью векторов $\bm{w}_{1}=(w_{i}^{(1)})$ и $\bm{w}_{2}=(w_{i}^{(2)})$ строятся взвешенные суммы (или одна сумма, когда векторы совпадают) матриц парных сравнений альтернатив:
        $$
        \bm{B}
        =
        \bigoplus_{i=1}^{m}w^{(1)}_{i}\bm{A}_{i},
        \qquad
        \bm{D}
        =
        \bigoplus_{i=1}^{m}w^{(2)}_{i}\bm{A}_{i}.
        $$
        \item[4.]
        Повторяя действия пунктов 1 и 2.1 (2.2) на основе взвешенной суммы $\bm{B}$ ($\bm{D}$) вычисляется вектор рейтингов альтернатив, соответствующий наилучшему (наихудшему) дифференцирующему вектору весов критериев.
        \end{itemize}

    \chapter{Разработка программных средств}

    \section{Разработка структуры для хранения чисел}

    В ходе решения есть шаг, на котором вычисляется линейно независимый набор векторов. При проверке линейной зависимости векторов недопустимо использование типов с плавающей точкой. Поэтому структура для хранения чисел должна быть основана на целочисленных типах, а операции сравнения должны быть точными.

    В задаче принятия решений даются матрицы парных сравнений из натуральных и обратных натуральным чисел.
    Для аналитического решения задачи принятия решения структура должна поддерживать операцию умножения, извлечения корня $n$-ой степени и отношение линейного порядка.
    Рациональных чисел $\displaystyle \frac{a}{b}$ не достаточно из-за операции извлечения корня. 
    Необходимо добавить к структуре числа корень целой степени:  $\displaystyle \left(\frac{a}{b}\right)^{1/n}$.
    
    Такое представление чисел в программе сужает max-алгебру с множества $\mathbb{R}_+$ на множество $\{x \in \mathbb{R}_+ \, |\, \exists a \in \mathbb{N} \cup 0, b \in \mathbb{N}, n \in \mathbb{N}: x = \displaystyle \left(\frac{a}{b}\right)^{1/n}\}$. Указанное множество замкнуто относительно операций умножения, извлечения корня целой степени, нахождения обратного элемента и линейно упорядочено. 

    С такой структурой операции и отношения определяются следующим образом:
    \begin{itemize}
        \item Умножение:
        $$ \left(\frac{a_1}{b_1}\right)^{1/n_1} \times \left(\frac{a_2}{b_2}\right)^{1/n_2} = \left(\frac{a_1^{n_2}a_2^{n_1}}{b_1^{n_2}b_2^{n_1}}\right)^{1/n_1n_2}.$$
        \item Сравнение:
        $$ \left(\frac{a_1}{b_1}\right)^{1/n_1} < \left(\frac{a_2}{b_2}\right)^{1/n_2} \Leftrightarrow
        \left(\frac{a_1^{n_2}}{b_1^{n_2}}\right)^{1/n_1n_2} < \left(\frac{a_2^{n_1}}{b_2^{n_1}}\right)^{1/n_1n_2}\Leftrightarrow
        \frac{a_1^{n_2}}{b_1^{n_2}} < \frac{a_2^{n_1}}{b_2^{n_1}}\Leftrightarrow
        {a_1^{n_2}}{b_2^{n_1}} < {a_2^{n_1}}{b_1^{n_2}}.$$
        \item Обратный элемент относительно умножения:
        $$ \left(\left(\frac{a}{b}\right)^{1/n}\right)^{-1} = \left(\frac{b}{a}\right)^{1/n}, \qquad a \neq 0.$$
    \end{itemize}
    Однако, если использовать такие формулы, числа будут увеличиваться очень быстро.
    Причем, часто $n_1$ и $n_2$ оказываются равными. Это мотивирует использовать НОД в формулах:
    $$n_1 =  n^*_1 \cdot \gcd(n_1, n_2), \qquad n_2 =  n^*_2 \cdot \gcd(n_1, n_2).$$

    \begin{itemize}
        \item Умножение:
        $$ \left(\frac{a_1}{b_1}\right)^{1/n_1} \times \left(\frac{a_2}{b_2}\right)^{1/n_2} = \left(\frac{a_1^{n^*_2}a_2^{n^*_1}}{b_1^{n^*_2}b_2^{n^*_1}}\right)^{1/n^*_1\cdot \gcd(n_1, n_2) \cdot n^*_2}.$$
        После умножения числитель и знаменатель сокращаются на их НОД.
        \item Сравнение:
        $$ \left(\frac{a_1}{b_1}\right)^{1/n_1} < \left(\frac{a_2}{b_2}\right)^{1/n_2} \Leftrightarrow
        {a_1^{n^*_2}}{b_2^{n^*_1}} < {a_2^{n^*_1}}{b_1^{n^*_2}}.$$
    \end{itemize}

    Реализация в листинге \ref{listing:fraction}.


    \section{Матрицы}
    Были реализованы элементы тропической математики такие, как нахождение следа, тропического определителя, транспонированный матрицы, спектрального радиуса, матрицы Клини, проверка линейной зависимости вектора от набора векторов, выбор ЛНЗ набора векторов из данных, нахождение лучших и худших дифференцирующих векторов в листинге \ref{listing:matrix}.


    \section{Вывод решения}
    К каждому классу был добавлен метод вывода в latex в листинге \ref{listing:to_latex}.
    



    \chapter{Пример решения практической задачи}
        \input{1.tex}

    \conclusion

    С такой неинтуитивной алгеброй приятно иметь калькулятор.
    
    В ходе решения задачи принятия решений числа могут стать очень большими, что может быть проблемой при больших размерностях входных матриц. Уже разработана более оптимизированная для max-умножить алгебры структура и ведется ее реализация.

    Разработанная структура может пригодиться и в других областях. Например, отсутствие ошибок округления важно дли криптографии.
    
    \renewcommand{\refname}{}
    \vspace{-25pt}
    \bibliographystyle{ugost2008}
    \bibliography{references}

    \appendix
        \chapter{Исходный код}

    % \renewcommand{\sectionfont}{\normalsize\bfseries}
    % \renewcommand{\theappendixfont}{\normalsize\bfseries}
    % \clearpage
    % \addcontentsline{toc}{chapter}{Приложения}
    \input{fraction.tex}
    \input{matrix.tex}
    \input{to_latex.tex}
    % \input{solution.tex}



\end{document}